Here are **detailed notes on âœ… 4. Ansible Inventory**, including types, syntax, advanced usage, examples, and **interview Q\&A (including scenarios)**. Links to **official documentation** are provided throughout.

---

# âœ… 4. Ansible Inventory â€“ Complete Guide

---

## ğŸ”¹ What is an Ansible Inventory?

An **inventory** in Ansible is a **list of managed nodes (hosts)** that the Ansible **control node communicates with**. It tells Ansible **what machines to target** for automation.

Ansible supports both:

* **Static inventory** (defined manually in files)
* **Dynamic inventory** (fetched in real-time from cloud providers, scripts, etc.)

ğŸ“˜ [Official Docs â€“ Inventory](https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html)

---

## ğŸ”¹ Inventory File Formats

Ansible inventory files can be written in:

* **INI format** (default and simple)
* **YAML format**
* **Dynamic inventory scripts or plugins**

---

## ğŸ”¹ 1. Static Inventory (INI Format)

```ini
# inventory.ini
[webservers]
192.168.1.10
web1.example.com

[dbservers]
db1 ansible_host=192.168.1.20 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_rsa
```

* `ansible_host`: IP or hostname if different from group name
* `ansible_user`: remote login username
* `ansible_ssh_private_key_file`: SSH key for authentication

ğŸ“˜ [INI Inventory Docs](https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#inventory-basics-host-list)

---

## ğŸ”¹ 2. Static Inventory (YAML Format)

```yaml
all:
  children:
    web:
      hosts:
        web1:
          ansible_host: 192.168.1.10
    db:
      hosts:
        db1:
          ansible_host: 192.168.1.20
          ansible_user: ubuntu
```

ğŸ“˜ [YAML Inventory Docs](https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#yaml-inventory)

---

## ğŸ”¹ 3. Dynamic Inventory

Ansible can generate inventory **dynamically** from cloud providers like AWS, Azure, GCP, OpenStack.

**Example: AWS inventory with boto:**

```bash
ansible-inventory -i aws_ec2.yml --graph
```

* Requires inventory plugins or dynamic scripts
* Cloud resources are discovered in real time

ğŸ“˜ [Dynamic Inventory Docs](https://docs.ansible.com/ansible/latest/user_guide/intro_dynamic_inventory.html)

---

## ğŸ”¹ 4. Inventory Groups

You can group hosts by function, location, or role.

```ini
[webservers]
web1
web2

[dbservers]
db1
db2

[production:children]
webservers
dbservers
```

* `:children` â€“ creates a group of groups
* `:vars` â€“ assign variables to entire groups

```ini
[webservers:vars]
ansible_user=ubuntu
ansible_port=22
```

ğŸ“˜ [Grouping Hosts](https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#hosts-and-groups)

---

## ğŸ”¹ 5. Host and Group Variables

You can define **variables** specific to hosts or groups.

**In inventory file:**

```ini
[dbservers]
db1 ansible_host=192.168.1.30 ansible_user=postgres ansible_port=5432
```

**In directory structure:**

```
inventory/
â”œâ”€â”€ hosts.ini
â”œâ”€â”€ group_vars/
â”‚   â””â”€â”€ webservers.yml
â”œâ”€â”€ host_vars/
â”‚   â””â”€â”€ db1.yml
```

**Example (group\_vars/webservers.yml):**

```yaml
ansible_user: ubuntu
env: production
```

ğŸ“˜ [Variables in Inventory](https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html#defining-variables-in-inventory)

---

## ğŸ”¹ 6. Testing the Inventory

Use the `ansible-inventory` command to test or view inventory:

```bash
ansible-inventory -i inventory.ini --list
ansible-inventory -i inventory.ini --graph
```

---

## ğŸ”¹ 7. Ad-Hoc Command Example with Inventory

```bash
ansible all -m ping -i inventory.ini
ansible webservers -m shell -a "uptime" -i inventory.ini
```

---

## âœ… Interview Questions & Answers (with Scenarios)

---

### â“ Q1: What is the purpose of the Ansible inventory?

**Answer:**
The inventory tells Ansible which hosts to manage and how to connect to them (IP, user, port, auth key). It can be static (INI/YAML) or dynamic (from cloud plugins).

---

### â“ Q2: How does a dynamic inventory work in Ansible?

**Answer:**
Dynamic inventory queries APIs (like AWS, Azure, etc.) to fetch real-time host lists. This is useful in cloud environments where IPs and instances change dynamically.

ğŸ“˜ [Dynamic Inventory](https://docs.ansible.com/ansible/latest/user_guide/intro_dynamic_inventory.html)

---

### â“ Q3: Can you define variables in inventory files?

**Answer:**
Yes, variables can be defined per-host or per-group in the inventory file, or in separate YAML files using `host_vars` and `group_vars` directories.

---

### â“ Q4: Scenario â€“ You have different SSH usernames for web and db servers. How will you handle it?

**Answer:**

**Solution:**
Use group variables in your inventory:

```ini
[webservers]
web1 ansible_user=ubuntu

[dbservers]
db1 ansible_user=postgres
```

Or use `group_vars/webservers.yml` and `group_vars/dbservers.yml`.

---

### â“ Q5: How do you organize large inventories with hundreds of servers?

**Answer:**

* Use **groups and subgroups**
* Use **group\_vars and host\_vars** for variables
* Use **dynamic inventory** for cloud environments
* Use **directory-based inventory** (`inventory/` with YAML files)

---

### â“ Q6: What command helps you view the structure of your inventory?

**Answer:**

```bash
ansible-inventory -i inventory.ini --graph
```

ğŸ“˜ [Inventory Graph](https://docs.ansible.com/ansible/latest/cli/ansible-inventory.html)

---

### â“ Q7: Whatâ€™s the default location of the Ansible inventory file?

**Answer:**
The default location is:

```bash
/etc/ansible/hosts
```

It can be overridden using the `-i` option or `ansible.cfg`.

---

## âœ… Summary Table

| Inventory Feature         | Description                           |
| ------------------------- | ------------------------------------- |
| Static Inventory          | Manually defined hosts in INI or YAML |
| Dynamic Inventory         | Auto-generated from APIs or scripts   |
| Groups                    | Logical classification of hosts       |
| Host/Group Vars           | Assign variables to hosts/groups      |
| `host_vars`, `group_vars` | Directory-based variables             |
| `ansible-inventory`       | CLI tool to view/test inventories     |

---

## ğŸ“š Official Documentation Links

| Topic                  | Link                                                                                             |
| ---------------------- | ------------------------------------------------------------------------------------------------ |
| Inventory Basics       | [Docs](https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html)                  |
| Grouping Hosts         | [Docs](https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#hosts-and-groups) |
| Dynamic Inventory      | [Docs](https://docs.ansible.com/ansible/latest/user_guide/intro_dynamic_inventory.html)          |
| Variables in Inventory | [Docs](https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html)              |
| CLI: ansible-inventory | [Docs](https://docs.ansible.com/ansible/latest/cli/ansible-inventory.html)                       |

---

Let me know when you're ready for âœ… **5. Ad-Hoc Commands** or want a **PDF export** of this entire Ansible notes series so far.
Here is the **simple and clear interview answer** for both commands:

---

# âœ… **1. Command:**

```
ansible-inventory -i inventory.ini --list
```

## **ğŸ¯ Output:**

* Shows the **full inventory in JSON format**.
* Displays:

  * All groups
  * Hosts inside each group
  * Group variables
  * Children groups
  * Host variables

## **ğŸ“ Example Output (simplified):**

```json
{
  "_meta": {
    "hostvars": {
      "web1": {},
      "db1": {}
    }
  },
  "webservers": {
    "hosts": ["web1"]
  },
  "dbservers": {
    "hosts": ["db1"]
  }
}
```

## **ğŸ§  Summary:**

Shows **detailed inventory information** in structured JSON.

---

# âœ… **2. Command:**

```
ansible-inventory -i inventory.ini --graph
```

## **ğŸ¯ Output:**

* Shows the **inventory in a tree (graph) format**.
* Very simple, human-readable group â†’ host mapping.

## **ğŸ“ Example Output (simplified):**

```
@all:
  |--@webservers:
  |    |--web1
  |--@dbservers:
       |--db1
```

## **ğŸ§  Summary:**

Shows a **graphical hierarchy** of groups and hosts.

---

# ğŸ”¥ **Difference (Very Simple)**

| Command   | Output              | Purpose                             |
| --------- | ------------------- | ----------------------------------- |
| `--list`  | JSON full inventory | Detailed data (hosts, vars, groups) |
| `--graph` | Tree format         | Visual group & host structure       |

---

# â­ One-Line Interview Answer

**`--list` gives complete inventory details in JSON, while `--graph` shows a simple tree of groups and hosts.**

---

If you want, I can also give example inventory.ini to practice.
