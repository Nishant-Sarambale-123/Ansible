Here are **detailed notes on âœ… 6. Ad-Hoc Commands in Ansible**, including syntax, modules, real-world examples, advantages, best practices, and **interview Q\&A with scenario-based questions**. Each section includes official documentation links.

---

# âœ… 6. Ad-Hoc Commands in Ansible â€“ Complete Guide

---

## ğŸ”¹ What are Ad-Hoc Commands?

**Ad-Hoc Commands** in Ansible are **one-liner commands** used to perform quick tasks **without writing a playbook**.

These are mostly used for:

* Simple configuration checks
* Troubleshooting
* Urgent updates
* Quick package installations or service restarts

ğŸ“˜ [Official Doc â€“ Ad-Hoc Commands](https://docs.ansible.com/ansible/latest/user_guide/intro_adhoc.html)

---

## ğŸ”¹ Syntax of Ad-Hoc Commands

```bash
ansible <target-host-pattern> -m <module> -a "<module-arguments>" [options]
```

| Component          | Description                           |
| ------------------ | ------------------------------------- |
| `<target-host>`    | Group or host from inventory          |
| `-m <module>`      | Module name (e.g., `ping`, `command`) |
| `-a "<arguments>"` | Arguments to pass to the module       |
| `-i inventory`     | Optional path to custom inventory     |
| `-u`               | SSH user                              |
| `-b` or `--become` | Run with sudo/root privileges         |

---

## ğŸ”¹ Common Examples of Ad-Hoc Commands

---

### âœ… 1. **Ping All Hosts**

Test connectivity using the `ping` module:

```bash
ansible all -m ping
```

ğŸ“˜ [ping module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/ping_module.html)

---

### âœ… 2. **Run Shell Commands**

```bash
ansible all -m shell -a "uptime"
ansible web -m shell -a "df -h"
```

ğŸ“˜ [shell module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/shell_module.html)

---

### âœ… 3. **Install a Package**

```bash
ansible webservers -b -m apt -a "name=nginx state=present"
```

ğŸ“˜ [apt module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html)

---

### âœ… 4. **Start/Restart a Service**

```bash
ansible all -b -m service -a "name=nginx state=restarted"
```

ğŸ“˜ [service module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html)

---

### âœ… 5. **Copy a File**

```bash
ansible web -m copy -a "src=./index.html dest=/var/www/html/index.html"
```

ğŸ“˜ [copy module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html)

---

### âœ… 6. **Create a Directory**

```bash
ansible all -b -m file -a "path=/opt/testdir state=directory mode=0755"
```

ğŸ“˜ [file module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html)

---

### âœ… 7. **Gather System Facts**

```bash
ansible all -m setup
```

ğŸ“˜ [setup module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html)

---

## ğŸ”¹ Common Flags Used with Ad-Hoc Commands

| Flag                | Purpose                               |
| ------------------- | ------------------------------------- |
| `-i`                | Inventory file                        |
| `-u`                | SSH username                          |
| `--ask-pass`        | Ask for SSH password                  |
| `-b`                | Run with sudo (become root)           |
| `--ask-become-pass` | Ask for sudo password                 |
| `-k`                | Prompt for SSH password (alternative) |

---

## ğŸ”¹ Advantages of Ad-Hoc Commands

* âœ… Quick and easy to use
* âœ… Great for troubleshooting or one-time fixes
* âœ… No need to write YAML/playbooks
* âœ… Ideal for exploratory tasks on inventory

---

## ğŸ”¹ Limitations of Ad-Hoc Commands

* âŒ Not reusable or version controlled
* âŒ Not ideal for complex workflows
* âŒ Difficult to audit or test
* âœ… Use Playbooks instead for repeatable tasks

---

## âœ… Interview Questions & Scenario-Based Q\&A

---

### â“ Q1: What are ad-hoc commands in Ansible?

**Answer:**
Ad-hoc commands are single-line shell commands that allow users to run tasks instantly using Ansible without creating a playbook. Theyâ€™re best for quick, one-off tasks.

---

### â“ Q2: Can you use ad-hoc commands for privilege escalation?

**Answer:**
Yes. Use the `-b` (become) option to run tasks as root or another privileged user:

```bash
ansible all -b -m apt -a "name=curl state=present"
```

---

### â“ Q3: Scenario â€“ You need to install a package on 100 servers urgently. What will you do?

**Answer:**
Use an ad-hoc command:

```bash
ansible all -b -m yum -a "name=git state=present"
```

Itâ€™s faster than writing and running a playbook when the task is one-time.

---

### â“ Q4: What module would you use to test SSH connectivity in ad-hoc?

**Answer:**
The `ping` module:

```bash
ansible all -m ping
```

---

### â“ Q5: How do you ensure a service is running using an ad-hoc command?

**Answer:**

```bash
ansible all -b -m service -a "name=nginx state=started"
```

---

### â“ Q6: Difference between `shell` and `command` module in ad-hoc?

**Answer:**

| `command`                        | `shell`                          |
| -------------------------------- | -------------------------------- |
| Safer, no shell features allowed | Can use pipes, redirects, env    |
| No variable expansion            | Yes, supports variable expansion |
| Faster execution                 | Slightly heavier                 |

---

## âœ… Summary Table

| Task              | Ad-Hoc Command Example                                       |
| ----------------- | ------------------------------------------------------------ |
| Ping all hosts    | `ansible all -m ping`                                        |
| Run shell command | `ansible all -m shell -a "uptime"`                           |
| Install a package | `ansible all -b -m apt -a "name=curl state=present"`         |
| Restart a service | `ansible web -b -m service -a "name=nginx state=restarted"`  |
| Copy a file       | `ansible web -m copy -a "src=index.html dest=/var/www/html"` |
| Gather facts      | `ansible all -m setup`                                       |

---

## ğŸ“š Official Documentation Links

* ğŸ”— [Ad-Hoc Commands](https://docs.ansible.com/ansible/latest/user_guide/intro_adhoc.html)
* ğŸ”— [Command-line Tools](https://docs.ansible.com/ansible/latest/cli/ansible.html)
* ğŸ”— [All Built-in Modules](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/index.html)

---

Let me know when you're ready for âœ… **7. Playbooks** or would like a **PDF export** of the full Ansible guide so far.
